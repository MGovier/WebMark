{
  "name": "WebMark",
  "tagline": "Offline-first efficient and responsive online marking",
  "body": "# WebMark\r\nA Meteor powered offline-first Web Application to enable efficient and flexible marking of assignments. Developed as a final year project for BSc Computer Science by Merlin Govier (UP663652) at the University of Portsmouth, UK.\r\n\r\n## Table of Contents\r\n\r\n- [User Guide](#user)\r\n- [Developer Guide](#developer)\r\n- [Deployment Guide](#deployment)\r\n- [License](#license)\r\n\r\n## User Guide\r\nThe [user guide](https://mgovier.github.io/WebMark/user/) details how to use the application as an end-user.\r\n\r\n## Developer Guide\r\n- Install [Meteor](https://www.meteor.com/). Requires v1.3+.\r\n- Clone this repo, in your terminal `cd` into the root folder.\r\n- Run `meteor npm install` to install node dependencies, then `meteor` to locally serve the application.\r\n\r\n### Code Style & Linting\r\nThis project aims to follow the [Meteor Guide Code Style](http://guide.meteor.com/code-style.html). Linting uses ESLint, with Airbnb's configuration. Run `meteor npm run lint` to check.\r\n\r\n### Project Structure\r\nDirectory | Purpose                           \r\n----------|-----------------------------------\r\nlib/      | Client and server shared functions, such as application routes and data schemas.\r\npublic/   | Files to serve directly to client, such as favicon.ico or robots.txt.\r\nserver/   | Code to only execute on the server only. This holds security configurations.\r\nclient/   | Client side code; including interface functions and CSS. Contains:\r\n          | **templates/**    : Contains HTML partials for use in the interface.\r\n          | **compatibility/**  : Modules that rely on exporting global objects.\r\n          | **lib/**         : SCSS components and reused JS functions.\r\n          | **controllers/** : JS functionality.\r\nbuilds/   | Self-contained application bundles for production testing and deployment.\r\n\r\n\r\n## Deployment\r\nThe application utilizes a Node.JS powered server, connected to MongoDB and running behind a reverse proxy TLS terminator. OAuth configuration will be required, and this will be handled by the application on first run, by using the log-in menu link.\r\n\r\nThe most recent versions tested successfully are shown below:\r\n\r\nRequirement | Version\r\n------------|-----------------------------\r\n[Node.JS](https://nodejs.org/en/)   | 0.10.44\r\n[MongoDB](https://www.mongodb.com/) | 3.2\r\n[Nginx](http://nginx.org/en/)       | 1.9.14\r\n\r\nAs of 1.3.1, Meteor requires the 0.10 Node.JS branch, but this may change in future releases. The most recent versions of other technologies should be compatible. Other reverse proxies can be used in place of Nginx, such as HAProxy.\r\n\r\n\r\n### Node.JS Server\r\nMeteor can produce a self-contained NodeJS bundle. To generate this, use `meteor build` from inside the project directory. If you will be deploying onto a different platform than that which you are currently on, specify which with the `--architecture` flag.\r\n\r\nEnvironment variables are required for the Meteor application:\r\n\r\nVariable                | Setting\r\n------------------------|-----------------------------------\r\nROOT_URL                | The domain path for the application, such as `https://example.com/marking`.\r\nHTTP_FORWARDED_COUNT    | Number of reverse proxies deployed in front of Node.JS - i.e. `1`.\r\nPORT                    | Port to listen to. This should match the reverse proxy's expected local address, such as 3000.\r\nNODE_ENV                | Set for npm modules. Use `production` for running in production.\r\nMONGO_URL               | Address for the MongoDB server. Follows pattern `mongodb://user:password@host:port/databasename`.\r\n\r\n\r\n### MongoDB\r\nEnsure MongoDB can only be accessed locally, and set suitable users with restricted roles.\r\n\r\n### Reverse Proxy & Security\r\nIf using Nginx, a good configuration for the TLS terminator can be sourced from the [Mozilla SSL Configuration Generator](https://mozilla.github.io/server-side-tls/ssl-config-generator/) and following [Remy van Elst's Nginx Security Advice](https://raymii.org/s/tutorials/Strong_SSL_Security_On_nginx.html). This requires a stronger Diffie-Hellman parameter than the default, which can be generated using\r\n```\r\ncd /etc/ssl/certs\r\nopenssl dhparam -out dhparam.pem 4096\r\n```\r\nThe reverse proxy needs to provide some HTTP headers for the Node.JS server. These are:\r\n```\r\nproxy_set_header X-Real-IP $remote_addr;  # http://wiki.nginx.org/HttpProxyModule\r\nproxy_set_header Host $host;  # pass the host header - http://wiki.nginx.org/HttpProxyModule#proxy_pass\r\nproxy_http_version 1.1;  # recommended with keepalive connections - http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_http_version\r\nproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\r\n# WebSocket proxying - from http://nginx.org/en/docs/http/websocket.html\r\nproxy_set_header Upgrade $http_upgrade;\r\nproxy_set_header Connection 'upgrade';\r\n```\r\n[This Gist](https://gist.github.com/MGovier/5112025ec482012163c6d563dd75ca32) shows the configuration used for production testing, and features redirects from both `http` and `www.` to `https` and `non-www`.\r\n\r\nDirect internet/public access to the Node.JS or MongoDB services should be prevented, potentially through firewall configuration.\r\n\r\n### Docker\r\nThe services can be managed using Docker and Docker Compose. Nginx can be configured as above, and an example configuration for the Node.JS server is:\r\n\r\n#### Dockerfile\r\n```\r\nFROM node:0.10\r\nENV ROOT_URL=\"https://example.me\"\r\nENV HTTP_FORWARDED_COUNT=1\r\nENV PORT=3000\r\nENV NODE_ENV=production\r\nENV MONGO_URL=\"mongodb://user:pass@mongo:27017/WebMark\"\r\nEXPOSE 3000\r\nADD WebMark.tar.gz /WebMark/\r\nRUN (cd WebMark/bundle/programs/server && npm install)\r\n```\r\n#### Start script (run `sh start`)\r\n```\r\ndocker rm -f webmark-host\r\ndocker build -t webmark-image .\r\ndocker run --name webmark-host --link mongo-host:mongo -p 127.0.0.1:3000:3000 --restart=always -d webmark-image node /WebMark/bundle/main.js\r\n```\r\nThis could enable a scalable design with Nginx load balancing between the available Node.JS servers, with Mongo also deployed across hosts.\r\n\r\n## License\r\nMIT\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}